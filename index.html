<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <title>115 學年度碩士班甄試 成績查詢</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <h1>國立中正大學 115 學年度</h1>
    <h2>碩士班甄試 成績查詢</h2>

    <form action="result.html" method="get" onsubmit="return verifyCode()">

        <label>身分證字號：</label>
        <input type="text" name="id" required>

        <label>准考證號碼：</label>
        <input type="text" name="exam" required>

        <label>驗證碼：</label><br>

        <canvas id="captchaCanvas" width="100" height="40"
                style="border:1px solid #555; border-radius:6px; cursor:pointer;"
                onclick="generateCaptcha()"></canvas>

        <input type="text" id="captchaInput" maxlength="4" required placeholder="請輸入驗證碼">

        <button type="submit">查詢成績</button>
    </form>
</div>

<script>
let realCode = "";

function generateCaptcha() {
    const canvas = document.getElementById("captchaCanvas");
    const ctx = canvas.getContext("2d");

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#f0f0f0";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    realCode = "";
    for (let i = 0; i < 4; i++) realCode += Math.floor(Math.random() * 10);

    for (let i = 0; i < 4; i++) {
        const char = realCode[i];
        ctx.font = `${20 + Math.random() * 6}px Arial`;
        ctx.fillStyle = `rgb(${50 + Math.random()*150}, ${50 + Math.random()*150}, ${50 + Math.random()*150})`;

        const x = 10 + i * 22;
        const y = 25 + Math.random() * 5;

        ctx.save();
        ctx.translate(x, y);
        ctx.rotate((Math.random() - 0.5) * 0.5);
        ctx.fillText(char, 0, 0);
        ctx.restore();
    }

    for (let i = 0; i < 5; i++) {
        ctx.strokeStyle = `rgba(0,0,0,0.2)`;
        ctx.beginPath();
        ctx.moveTo(Math.random()*100, Math.random()*40);
        ctx.lineTo(Math.random()*100, Math.random()*40);
        ctx.stroke();
    }
}

function verifyCode() {
    const input = document.getElementById("captchaInput").value;
    if (input !== realCode) {
        alert("驗證碼錯誤，請再試一次！");
        generateCaptcha();
        return false;
    }
    return true;
}

window.onload = generateCaptcha;
</script>

</body>
</html>
